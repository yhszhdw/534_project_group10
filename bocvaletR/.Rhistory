search()
install.packages(c(
"usethis",
"devtools",
"httr2",
"jsonlite",
"tibble",
"dplyr",
"tidyr",
"ggplot2",
"testthat"
))
getwd()
usethis::use_r("boc_request")
devtools::load_all()
usethis::use_r("boc_series")
devtools::load_all()
df <- boc_series(
"FXUSDCAD",
start_date = "2024-01-01",
end_date   = "2024-03-31"
)
head(df)
usethis::use_r("boc_plot")
devtools::load_all()
boc_plot(df)
usethis::use_vignette("bank-of-canada-api")
library(bocvaletR)
df <- boc_series(
"FXUSDCAD",
start_date = "2024-01-01",
end_date   = "2024-03-31"
)
head(df)
boc_plot(df)
devtools::build_vignettes()
devtools::document()
devtools::load_all()
devtools::build_vignettes()
library(MPV)
install.packages(MPV)
getwd()
devtools::load_all()
library(bocvaletR)
series <-boc_list_series()
head(series)
exchange <- boc_list_series(keyword='exchange',limit=5)
exchange
groups <-boc_list_groups()
heand(groups)
groups <-boc_list_groups()
head(groups)
FX <- boc_list_groups(keyword = 'FX')
FX
FX
boc_groups()
FX[2]
FX[,2]
FX[2,]
FX[4,] #this is the group information retrieved from section 2.2
FX_RATE_DAILY = boc_groups(FX[4,]$id)
head(FX_RATE_DAILY)
FX[4,] #this is the group information retrieved from section 2.2
FX_RATE_DAILY = boc_groups(FX[4,]$id)
FX_RATE_DAILY$group
FX_RATE_DAILY$series
FX[4,] #this is the group information retrieved from section 2.2
FX_RATE_DAILY = boc_groups(FX[4,]$id)
FX_RATE_DAILY$series
fx <- boc_series("FXUSDCAD")
head(fx)
ids <- c("FXUSDCAD", "FXEURCAD")
fx_multi <- boc_series(ids)
head(fx_multi)
groups <- boc_list_groups(keyword = "exchange", limit = 1)
group_id <- groups$id[1]
group_data <- boc_groups(group_id)
series_ids <- unique(group_data$id)
fx_selected <- boc_series(series_ids[1:2])
groups <- boc_list_groups(keyword = "exchange", limit = 1)
group_id <- groups$id[1]
group_data <- boc_groups(group_id)
series_ids <- unique(group_data$series$id)
fx_selected <- boc_series(series_ids[1:2])
groups <- boc_list_groups(keyword = "exchange", limit = 1)
group_id <- groups$id[1]
group_data <- boc_groups(group_id)
series_ids <- unique(group_data$series$id)
fx_selected <- boc_series(series_ids[1:2])
head(fx_selected)
rss <- boc_fx_rss()
rss
rss_id <-boc_fx_rss_available()
rss_id <-boc_fx_rss_available()
rss_id
rss <- boc_fx_rss()
rss
#retrieving single fx_rss with rss_id
rss_AUD <- boc_fx_rss(rss_id$item_series[1])
rss_AUD
library(bocvaletR)
getwd()
devtools::load_all()
library(bocvaletR)
library(dplyr)
fx <- boc_series(c("FXUSDCAD", "FXEURCAD"), start_date = "2023-01-01")
head(fx)
set.seed(42)
fx_sim <- fx %>%
arrange(series, date) %>%
group_by(series) %>%
mutate(
value_sim = value,
# randomly set some points to NA to simulate missingness
value_sim = ifelse(runif(n()) < 0.05, NA_real_, value_sim)
) %>%
ungroup()
fx_sim %>%
summarise(n = n(), n_missing = sum(is.na(value_sim)))
fx_locf <- boc_fill_missing(
data = fx_sim,
value_col = "value_sim",
method = "locf",
order_col = "date",
group_col = "series",
new_col = "filled_locf"
)
fx_locf %>% select(date, series, value_sim, filled_locf) %>% head(10)
fx_linear <- boc_fill_missing(
data = fx_sim,
value_col = "value_sim",
method = "linear",
order_col = "date",
group_col = "series",
new_col = "filled_linear"
)
fx_linear %>% select(date, series, value_sim, filled_linear) %>% head(10)
fx_index <- boc_normalize(
data = fx_locf,
value_col = "filled_locf",
method = "index",
index_base = 100,
group_col = "series",
new_col = "index_100"
)
fx_index %>% select(date, series, filled_locf, index_100) %>% head(10)
cor_mat <- boc_correlation(
data = fx_locf %>% select(date, series, value = filled_locf),
value_col = "value"
)
fx_ret <- boc_percent_change(
data = fx_locf,
value_col = "filled_locf",
periods = 1,
type = "log",
order_col = "date",
group_col = "series",
new_col = "log_ret"
)
fx_ret %>% select(date, series, filled_locf, log_ret) %>% head(10)
fx_roll <- boc_rolling_mean(
data = fx_locf,
value_col = "filled_locf",
window = 10,
order_col = "date",
group_col = "series",
new_col = "ma10"
)
fx_roll %>% select(date, series, filled_locf, ma10) %>% head(10)
summ <- boc_summary(
data = fx_sim,
value_col = "value_sim",
order_col = "date",
group_col = "series"
)
summ
acf_tbl <- boc_autocorr(
data = fx_locf,
value_col = "filled_locf",
lag_max = 10,
group_col = "series"
)
head(acf_tbl)
# Ensure at least two series are present before correlation
fx_corr_input <- fx_locf %>%
filter(series %in% c("FXUSDCAD", "FXEURCAD")) %>%
select(date, series, value = filled_locf)
# quick sanity check
fx_corr_input %>% count(series)
cor_mat <- boc_correlation(
data = fx_corr_input,
value_col = "value"
)
fx_corr_input <- fx_locf %>%
select(date, series, value = filled_locf) %>%
ungroup()
# MUST check right here (prints what boc_correlation will see)
fx_corr_input %>% distinct(series) %>% print()
dplyr::n_distinct(fx_corr_input$series)
corr_demo <- tibble::tibble(
date = as.Date("2023-01-01") + 0:29,
series = rep(c("S1", "S2"), each = 30),
value = c(
cumsum(rnorm(30, 0, 1)),
cumsum(rnorm(30, 0, 1)) + 0.5
)
)
fx_corr_input <- fx_locf %>%
dplyr::select(date, series, value = filled_locf) %>%
dplyr::ungroup()
fx_corr_input %>% dplyr::count(series) %>% print()
cat("n_distinct(series) =", dplyr::n_distinct(fx_corr_input$series), "\n")
devtools::load_all()
devtools::load_all()
cor_mat <- boc_correlation(
data = fx_locf %>% dplyr::select(date, series, value = filled_locf),
value_col = "value"
)
cor_mat
library(bocvaletR)
exchange <- boc_list_series(keyword='exchange',limit=5)
exchange
ids <- c("FXUSDCAD", "FXEURCAD")
fx_multi <- boc_series(ids)
head(fx_multi)
FX <- boc_list_groups(keyword = 'FX')
FX
FX[4,] #this is the group information retrieved from section 2.2
FX_RATE_DAILY = boc_groups(FX[4,]$id)
FX_RATE_DAILY$series
FX[4,] #this is the group information retrieved from section 2.2
FX_RATE_DAILY = boc_groups(FX[4,]$id)
FX_RATE_DAILY$series
boc_series(FX_RATE_DAILY$series$id)
View(fx_sim)
View(fx_sim)
fx_usd <- boc_series("FXUSDCAD")
head(fx_usd)
boc_plot(fx_usd)
fx_multi <- boc_series(c("FXUSDCAD", "FXEURCAD"))
head(fx_multi)
boc_plot(fx_multi)
boc_plot(fx_multi, mode = "facet")
devtools::document()
boc_plot(fx_multi, mode = "facet")
boc_plot(fx_multi)
devtools::install()
plots <- boc_plot(fx_multi, mode = "separate")
names(plots)
plots$FXUSDCAD
fx_list <- boc_series(
c("FXUSDCAD", "FXEURCAD"),
concat = FALSE
)
str(fx_list, max.level = 1)
boc_plot(fx_list)                 # overlay (default)
boc_plot(fx_list, mode = "facet")
boc_plot(fx_list, mode = "separate")
boc_plot(
fx_multi,
title = "Daily Exchange Rates against CAD",
xlab  = "Date",
ylab  = "Exchange Rate"
)
boc_plot(fx_multi, legend = FALSE)
fx_usd <- boc_series("FXUSDCAD", start_date = "2023-01-01")
head(fx_usd)
fx_usd <- fx_usd[order(fx_usd$date), ]
fx_usd$log_ret <- c(NA_real_, diff(log(fx_usd$value)))
ret <- fx_usd$log_ret
ret <- ret[is.finite(ret)]   # remove NA/NaN/Inf
length(ret)
stats_95 <- risk_var_cvar(ret, alpha = 0.05)
stats_95
vis <- risk_plot_var_cvar(
ret,
alpha = 0.05,
title = "Historical VaR / CVaR for FXUSDCAD (daily log returns)"
)
vis$plot
txt <- risk_text_summary(
n     = length(ret),
alpha = 0.05,
var   = vis$var,
cvar  = vis$cvar
)
cat(txt)
# Ensure data are ordered by date
fx_usd <- fx_usd[order(fx_usd$date), ]
# Step 1: (Optional) Fill missing values in levels
# This step is shown for completeness; FX series typically have few missing values.
fx_filled <- boc_fill_missing(
data      = fx_usd,
value_col = "value",
method    = "locf",
order_col = "date",
group_col = "series",
new_col   = "value_filled"
)
# Step 2: Compute daily log returns using helper
fx_ret <- boc_percent_change(
data      = fx_filled,
value_col = "value_filled",
periods   = 1,
type      = "log",
order_col = "date",
group_col = "series",
new_col   = "log_ret"
)
# Extract return vector for risk analysis
ret <- fx_ret$log_ret
ret <- ret[is.finite(ret)]
length(ret)
stats_95 <- risk_var_cvar(ret, alpha = 0.05)
stats_95
vis <- risk_plot_var_cvar(
ret,
alpha = 0.05,
title = "Historical VaR / CVaR for FXUSDCAD (daily log returns)"
)
vis$plot
txt <- risk_text_summary(
n     = length(ret),
alpha = 0.05,
var   = vis$var,
cvar  = vis$cvar
)
cat(txt)
